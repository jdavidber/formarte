var datosQ10, jQuery = jQuery.noConflict(),
    token = "",
    q10Token = function() {
        jQuery.ajax({
            type: "POST",
            url: "https://www.q10academico.com/token",
            data: "UserName=apihorarios&Password=0c904eca8fb3&grant_type=password&aplentId=F2BD7F9A-10E2-4E1D-8F84-B8A30201F967",
            success: function(e) {
                token = e.access_token, window.q10down = !1, obtenerDatosQ10();
            },
            error: function(e) {
                window.q10down = !0, console.warn(e)
            }
        })
    },
    obtenerDatosQ10 = function() {
        jQuery.ajax({
            type: "GET",
            beforeSend: function(e) {
                e.setRequestHeader("Authorization", "BEARER " + token)
            },
            url: "https://www.q10academico.com/api/informacionHorarios",
            success: function(e) {
                datosQ10 = e, cursosq10Init(), localStorage.getItem("programa") ? secondStep(!0) : jQuery("ul.categorias li a").on("click", function() {
                    firstStep(jQuery(this).data("categoria"))
                })
            },
            error: function(e) {
                console.warn(e)
            }
        })
    }

function q10Regresar() {
    jQuery("ul.categorias").fadeIn(), jQuery("ul.programas, .step1Regresar").hide()
}

function firstStep(e) {
    jQuery("ul.categorias").show(), jQuery("ul.programas, .step1Regresar").hide(), jQuery("ul.programas").html("");
    jQuery("#q10Programas ul.categorias");
    for (var r = jQuery("#q10Programas ul.programas"), t = jQuery.grep(datosQ10, function(e) {
            return e.Sede === localStorage.getItem("ciudad")
        }), a = [], o = [], s = [], i = 0; i < t.length; i++) a.push(t[i].Programa);
    var n = a.filter(function(e, r, t) {
        return t.indexOf(e) >= r
    });
    for (i = 0; i < n.length; i++) {
        var u = n[i].split("-");
        u = u[1] && u[1].match("2016") || u[1] && u[1].match("2017") ? (u = u[1].split("2016") || u[1].split("2017"))[0] : u[1], o.push(u)
    }
    var l = o.filter(function(e, r, t) {
        return t.indexOf(e) >= r
    });
    for (i = 0; i < l.length; i++) "string" == typeof l[i] && l[i].search(e) >= 0 && s.push(l[i]);
    jQuery("ul.categorias").hide(), jQuery("ul.programas, .step1Regresar").fadeIn(), s.sort();
    for (i = 0; i < s.length; i++) localStorage.getItem("programa") && localStorage.getItem("programa") === s[i] ? r.append('<li><a href="javascript:void(0);" class="selectProgram active">' + s[i] + "</a></li>") : r.append('<li><a href="javascript:void(0);" class="selectProgram">' + s[i] + "</a></li>");
    jQuery(".selectProgram").on("click", function(e) {
        var r = jQuery(this).text();
        e.preventDefault(), jQuery(".active").removeClass("active"), jQuery(this).addClass("active"), hideModal("q10Programas"), localStorage.setItem("programa", r), jQuery("#q10Periodos ul").html(""), jQuery("#tresw-loader").show(), setTimeout(function() {
            jQuery("#tresw-loader").fadeOut(), secondStep()
        }, 1e3)
    })
}

function secondStep(e) {
    var r = jQuery("#q10Periodos ul"),
        t = jQuery.grep(datosQ10, function(e) {
            return e.Sede === localStorage.getItem("ciudad")
        }),
        a = jQuery.grep(t, function(e) {
            return e.Programa.match(localStorage.getItem("programa"))
        }),
        o = [];
    jQuery(".step-active").removeClass("step-active"), jQuery(".step-2").addClass("step-active"), jQuery("#steps-bar").fadeIn(), jQuery("#text-progress-bar").text("Muy bien! Ya diste el primer paso."), jQuery("#progress-bar").css("width", "50%");
    for (var s = 0; s < a.length; s++) o.push(a[s].Periodo);
    var i = o.filter(function(e, r, t) {
        return t.indexOf(e) >= r
    });
    i.sort();
    for (s = 0; s < i.length; s++) {
        var n = "PREPÁRATE PARA EL EXAMEN DEL 1er SEMESTRE",
            u = "";
        "2016-2" !== i[s] && "2017-2" !== i[s] || (n = "PREPÁRATE PARA EL EXAMEN DEL 2do SEMESTRE", u = ""), localStorage.getItem("periodo") && localStorage.getItem("periodo") === i[s] ? r.append('<li class="semestre"><a href="javascript:void(0);" data-periodo="' + i[s] + '" class="selectPeriodo active"><h3>' + n + "</h3></a><p>" + u + "</p></li>") : r.append('<li class="semestre"><a href="javascript:void(0);" data-periodo="' + i[s] + '" class="selectPeriodo"><h3>' + n + "</h3><p>" + u + "</p></a></li>")
    }
    e ? jQuery("#step-1").removeAttr("href") : setTimeout(function() {
        showModal("q10Periodos")
    }, 1e3), jQuery(".selectPeriodo").on("click", function(e) {
        var r = jQuery(this).data("periodo");
        e.preventDefault(), jQuery(".active").removeClass("active"), jQuery(this).addClass("active"), hideModal("q10Periodos"), localStorage.setItem("periodo", r), jQuery("#q10Jornadas ul").html(""), jQuery("#tresw-loader").show(), setTimeout(function() {
            jQuery("#tresw-loader").fadeOut(), thirdStep()
        }, 1e3)
    })
}

function thirdStep() {
    var e = jQuery("#q10Jornadas ul"),
        r = jQuery.grep(datosQ10, function(e) {
            return e.Sede === localStorage.getItem("ciudad")
        }),
        t = jQuery.grep(r, function(e) {
            return e.Programa.match(localStorage.getItem("programa"))
        }),
        a = jQuery.grep(t, function(e) {
            return e.Periodo === localStorage.getItem("periodo")
        }),
        o = [];
    jQuery(".step-active").removeClass("step-active"), jQuery(".step-3").addClass("step-active"), jQuery("#text-progress-bar").text("¡Estas a un paso! Es simple y fácil."), jQuery("#progress-bar").css("width", "75%");
    for (var s = 0; s < a.length; s++) o.push(a[s].Jornada);
    var i = o.filter(function(e, r, t) {
        return t.indexOf(e) >= r
    });
    i.sort();
    for (s = 0; s < i.length; s++) localStorage.getItem("jornada") && localStorage.getItem("jornada") === i[s] ? e.append('<li><a href="javascript:void(0);" class="selectJornada active">' + i[s] + "</a></li>") : e.append('<li><a href="javascript:void(0);" class="selectJornada">' + i[s] + "</a></li>");
    setTimeout(function() {
        showModal("q10Jornadas")
    }, 1e3), jQuery(".selectJornada").on("click", function(e) {
        var r = jQuery(this).text();
        e.preventDefault(), jQuery(".active").removeClass("active"), jQuery(this).addClass("active"), hideModal("q10Jornadas"), localStorage.setItem("jornada", r), jQuery("#tresw-loader").show(), setTimeout(function() {
            jQuery("#tresw-loader").fadeOut(), fourthStep()
        }, 1e3)
    })
}

function fourthStep() {
    var e = jQuery("#q10tablaHorarios > table > tbody"),
        r = jQuery.grep(datosQ10, function(e) {
            return e.Sede === localStorage.getItem("ciudad")
        }),
        t = jQuery.grep(r, function(e) {
            return e.Programa.match(localStorage.getItem("programa"))
        }),
        a = jQuery.grep(t, function(e) {
            return e.Periodo === localStorage.getItem("periodo")
        }),
        o = jQuery.grep(a, function(e) {
            return e.Jornada === localStorage.getItem("jornada")
        }),
        s = ["Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio", "Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre"];
    e.html(" "), jQuery(".step-active").removeClass("step-active"), jQuery(".step-4").addClass("step-active"), jQuery("#text-progress-bar").text("¡Eso es todo! A continuación elige el horario."), jQuery("#progress-bar").css("width", "100%");
    for (var i = 0; i < o.length; i++) {
        var n = o[i],
            u = new Date(n.Fecha_Inicio_Clases),
            l = u.getDate(),
            c = u.getMonth(),
            d = new Date(o[0].Fecha_Final_Pagos),
            p = d.getDate(),
            g = d.getMonth(),
            f = d.getFullYear();
        jQuery("#q10tablaHorarios .thTitulo").text(localStorage.getItem("programa")), jQuery("#q10tablaHorarios .thJornada").text(localStorage.getItem("jornada")), jQuery("#q10tablaHorarios .thPeriodo").text(localStorage.getItem("periodo")), jQuery("#thBarraTitulo .valorContado span").text("$" + formatoCifra(o[0].Valor_Contado)), jQuery(".valorFinanciado2 , #thBarraTitulo .valorFinanciado span").text("$" + formatoCifra(o[0].Valor_Financiado)), jQuery("#thBarraTitulo .valorCuotas h5").text(o[0].Numero_Cuotas + " cuotas"), jQuery("#thBarraTitulo .valorCuotas span").text("$" + formatoCifra(o[0].Valor_Financiado / o[0].Numero_Cuotas)), jQuery(".validoHasta").text(p + " de " + s[g] + " del " + f), e.append('<tr data-programa="' + n.Consecutivo + '"><td><input id="' + n.Consecutivo + '" name="' + n.Consecutivo + '" type="radio"></input>' + l + " de " + s[c] + '</td><td style="text-align: left">' + n.Descripcion + '</td><td><strong style="color: #05e06d;"><span style="font-size: 24px; font-weight: normal;">' + n.Porcentaje_Descuento + '%</span></strong></td><td width="150"><strong style="color: #05e06d;">$' + formatoCifra(n.Valor_Contado_Con_Descuento) + '</strong></td><td width="150"><strong style="color: #05e06d">$' + formatoCifra(n.Valor_Financiado_Con_Descuento) + "<br />" + n.Numero_Cuotas + " cuotas $" + formatoCifra(n.Valor_Financiado_Con_Descuento / n.Numero_Cuotas) + "</strong></td></tr>")
    }
    setTimeout(function() {
        jQuery("#q10tablaHorarios").fadeIn(), displayTooltip("HAZ CLIC SOBRE EL HORARIO QUE DESEAS MATRICULAR", 250, -195)
    }, 1e3), setTimeout(function() {
        jQuery("html, body").animate({
            scrollTop: jQuery("#q10tablaHorarios").offset().top - 200
        }, 500)
    }, 2500), jQuery("#q10tablaHorarios tbody tr").on("click", function(e) {
        var r = jQuery(this).data("programa");
        jQuery("#q10tablaHorarios tbody tr").removeClass("active"), jQuery("#q10tablaHorarios tbody tr input").removeAttr("checked"), jQuery(this).addClass("active"), jQuery(this).find("input").attr("checked", "checked"), jQuery("#q10tablaHorarios .comprar").attr({
            href: "http://formartecentral.q10academico.com/formarte/preinscripcion/" + r,
            target: "_blank"
        })
    }), jQuery("#q10tablaHorarios .comprar").on("click", function() {
        jQuery("#q10tablaHorarios").offset().top
    })
}

function displayTooltip(e, r, t) {
    var a = jQuery(".frmt-tooltip");
    a.text(e), a.css({
        left: t + "px",
        top: r + "px"
    }), setTimeout(function() {
        a.css("opacity", "1")
    }, 3e3), setTimeout(function() {
        a.fadeOut()
    }, 15e3)
}

function showModal(e) {
    jQuery("#" + e).removeClass("hideModal").addClass("showModal"), jQuery(".edgtf-wrapper").addClass("blurred")
}

function hideModal(e) {
    jQuery(".edgtf-wrapper").removeClass("blurred"), jQuery("#" + e).removeClass("showModal").addClass("hideModal"), jQuery("ul.categorias").show(), jQuery("ul.programas").hide()
}

function formatoCifra(e) {
    for (var r = (e += "").split("."), t = r[0], a = r.length > 1 ? "." + r[1] : "", o = /(\d+)(\d{3})/; o.test(t);) t = t.replace(o, "$1.$2");
    return t + a
}
jQuery(document).ready(function() {
    q10Token();
    enviarDataPhp();
});